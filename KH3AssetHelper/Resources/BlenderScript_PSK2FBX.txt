import os
import bpy
import sys
import math

from bpy.props import *

if '--' in sys.argv:
    argv = sys.argv[sys.argv.index('--') + 1:]

print(argv)

srcPath=argv[0]
dstPath=argv[1]
pluginPath=argv[2]

print("srcPath: " + srcPath)
print("dstPath: " + dstPath)
print("pluginPath: " + pluginPath)

context = bpy.context
scene = context.scene

sys.path.append(pluginPath)
from io_import_scene_unreal_psa_psk_280 import *

#clear the scene
for c in scene.collection.children:
    scene.collection.children.unlink(c)

try:
    bpy.ops.wm.read_homefile(use_empty=True)
    if not os.path.exists(dstPath):
        pskimport(filepath = srcPath,context = bpy.context)
        bpy.ops.export_scene.fbx(filepath = dstPath)

except Exception as e: 
    print(e)
exit()